<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Título dinámico -->
  <title><%= texts.title %></title>
  <!-- Metadatos, SEO, etc. -->
  <meta name="description" content="Ayuba es una protectora de gatos comprometida con el rescate, cuidado y adopción de felinos. ¡Únete a nosotros para ayudar!">
  <meta name="keywords" content="Ayuba, protectora de gatos, rescate, adopción, voluntariado, gatos">
  <meta name="author" content="Ayuba">
  <link rel="stylesheet" href="/css/style.css">
  <style>
    /* Estilos para el modal */
    .modal {
      display: none; /* Oculto por defecto */
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.5); /* Velo oscuro transparente */
    }
    .modal-content {
      background-color: #fff;
      margin: 15% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 300px;
      text-align: center;
      border-radius: 4px;
    }
    .modal-content button {
      margin-top: 10px;
      padding: 8px 16px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <!-- Menú fijo en la parte superior -->
  <header class="site-header">
    <div class="menu">
      <div class="logo">Ayuba</div>
      <nav class="nav">
        <ul>
          <li><a href="#quienes-somos">Quienes Somos</a></li>
          <li><a href="#nuestra-labor">Nuestra Labor</a></li>
          <li><a href="#como-ayudar">Cómo Puedes Ayudar</a></li>
          <% if (sectionsVisibility.adopta) { %>
            <li><a href="#adopta">Adopta</a></li>
          <% } %>
          <% if (sectionsVisibility.socios) { %>
            <li><a href="#socios">Socios</a></li>
          <% } %>
          <% if (sectionsVisibility.voluntarios) { %>
            <li><a href="#voluntarios">Voluntarios</a></li>
          <% } %>
          <li><a href="#contacta">Contacta</a></li>
        </ul>
      </nav>
      <div class="hamburger">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </header>

  <!-- Header/hero: imagen de fondo con velo y texto centrado (100% de pantalla) -->
  <section class="header-section" style="background-image: url('<%= images.hero %>');">
    <div class="header-content">
      <h1><%= texts.headerHeroTitle %></h1>
      <p><%= texts.headerHeroSubtitle %></p>
    </div>
  </section>

  <!-- Sección: Quienes Somos (Texto izquierda, Imagen derecha) -->
  <section id="quienes-somos" class="section quienes-somos two-columns">
    <div class="text-column">
      <h2><%= texts.quienesSomosTitle %></h2>
      <p><%= texts.quienesSomosDesc %></p>
    </div>
    <div class="image-column">
      <img src="<%= images.quienes %>" alt="Quienes Somos">
    </div>
  </section>

  <!-- Sección: Nuestra Labor (Imagen izquierda, Texto derecha) -->
  <section id="nuestra-labor" class="section nuestra-labor two-columns reverse">
    <div class="text-column">
      <h2><%= texts.laborTitle %></h2>
      <p><%= texts.laborDesc %></p>
    </div>
    <div class="image-column">
      <img src="<%= images.labor %>" alt="Nuestra Labor">
    </div>
  </section>

  <!-- Sección: Como Puedes Ayudar (Texto izquierda, Imagen derecha) -->
  <section id="como-ayudar" class="section como-ayudar two-columns">
    <div class="text-column">
      <h2><%= texts.ayudaTitle %></h2>
      <p><%= texts.ayudaDesc %></p>
    </div>
    <div class="image-column">
      <img src="<%= images.ayuda %>" alt="Cómo Puedes Ayudar">
    </div>
  </section>

  <!-- Sección: Adopta (opcional, Texto izquierda, Imagen derecha) -->
  <% if (sectionsVisibility.adopta) { %>
    <section id="adopta" class="section adopta two-columns">
      <div class="text-column">
        <h2><%= texts.adoptaTitle %></h2>
        <p><%= texts.adoptaDesc %></p>
      </div>
      <div class="image-column">
        <img src="<%= images.adopta %>" alt="Adopta">
      </div>
    </section>
  <% } %>

  <!-- Sección: Socios (opcional, Imagen izquierda, Texto derecha) -->
  <% if (sectionsVisibility.socios) { %>
    <section id="socios" class="section socios two-columns reverse">
      <div class="text-column">
        <h2><%= texts.sociosTitle %></h2>
        <p><%= texts.sociosDesc %></p>
      </div>
      <div class="image-column">
        <img src="<%= images.socios %>" alt="Socios">
      </div>
    </section>
  <% } %>

  <!-- Sección: Voluntarios (opcional) -->
  <% if (sectionsVisibility.voluntarios) { %>
    <section id="voluntarios" class="section voluntarios two-columns">
      <div class="text-column">
        <h2><%= texts.voluntariosTitle %></h2>
        <p><%= texts.voluntariosDesc %></p>
      </div>
      <div class="image-column">
        <img src="<%= images.voluntarios %>" alt="Voluntarios">
      </div>
    </section>
  <% } %>

  <!-- Sección: Contacta (Imagen izquierda, Texto derecha, con nuevo campo de asunto y select) -->
  <section id="contacta" class="section contacta two-columns reverse">
    <div class="text-column">
      <h2><%= texts.contactaTitle %></h2>
      <p><%= texts.contactaDesc %></p>
      <form action="/contact" method="POST" class="contact-form" novalidate>
        <input type="text" name="name" placeholder="<%= texts.contactaPlaceholderName %>" required>
        <span class="error-message"></span>
        
        <input type="email" name="email" placeholder="<%= texts.contactaPlaceholderEmail %>" required>
        <span class="error-message"></span>
        
        <input type="text" name="userSubject" placeholder="<%= texts.contactaPlaceholderSubject %>" required>
        <span class="error-message"></span>
        
        <select name="asuntoSelect" required>
          <option value=""><%= texts.contactaSelectDefault %></option>
          <% if (sectionsVisibility.adopta) { %>
            <option value="<%= texts.contactaSelectAdopcion %>"><%= texts.contactaSelectAdopcion %></option>
          <% } %>
          <option value="<%= texts.contactaSelectSocios %>"><%= texts.contactaSelectSocios %></option>
          <option value="<%= texts.contactaSelectVoluntarios %>"><%= texts.contactaSelectVoluntarios %></option>
        </select>
        <span class="error-message"></span>
        
        <textarea name="message" placeholder="<%= texts.contactaPlaceholderMessage %>" required></textarea>
        <span class="error-message"></span>
        
        <button type="submit"><%= texts.contactaBtnText %></button>
      </form>
    </div>
    <div class="image-column">
      <img src="<%= images.contacta %>" alt="Contacta">
    </div>
  </section>

  <footer>
    <p>&copy; <%= new Date().getFullYear() %> Ayuba. <%= texts.footerRights %></p>
  </footer>

  <!-- Modal para confirmación -->
  <div id="successModal" class="modal">
    <div class="modal-content">
      <p>El mensaje ha sido enviado correctamente.</p>
      <button id="closeModal">Cerrar</button>
    </div>
  </div>

  <!-- Script para envío AJAX y manejo del modal -->
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const form = document.querySelector('.contact-form');
      form.addEventListener('submit', async function(e) {
        e.preventDefault(); // Prevenir envío tradicional

        // Recoger datos del formulario
        const formData = new FormData(form);
        const data = Object.fromEntries(formData.entries());
        
        try {
          const response = await fetch('/contact', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(data)
          });
          const result = await response.json();
          
          if (result.success) {
            // Limpiar el formulario
            form.reset();
            // Mostrar el modal de confirmación
            const modal = document.getElementById("successModal");
            modal.style.display = "block";
          } else {
            // Opcional: manejar el error (mostrar mensaje, etc.)
            console.error("Error:", result.message);
          }
        } catch (err) {
          console.error("Error al enviar el formulario:", err);
        }
      });
      
      // Cerrar modal
      const closeModalBtn = document.getElementById("closeModal");
      closeModalBtn.addEventListener("click", function() {
        document.getElementById("successModal").style.display = "none";
      });
    });
  </script>

  <script src="/js/main.js"></script>
</body>
</html>
